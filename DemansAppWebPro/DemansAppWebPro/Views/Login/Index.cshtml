@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Giriş Yap - DemansApp</title>
    <link rel="icon" type="image/x-icon" href="~/img/logo.png">
    <link href="~/assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/sweet-alert2/sweetalert2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />

    <style>
        .body {
            background: #ed5b2d;
            transition: all .2s;
            padding: 1px;
            min-height: 100vh;
            align-items: center;
            justify-content: center;
        }

        .site-link {
            padding: 5px 15px;
            position: fixed;
            z-index: 99999;
            background: #fff;
            box-shadow: 0 0 4px rgba(0,0,0,.14), 0 4px 8px rgba(0,0,0,.28);
            right: 30px;
            bottom: 30px;
            border-radius: 10px;
        }

            .site-link img {
                width: 30px;
                height: 30px;
            }

        .veen {
            width: 70%;
            margin: 200px auto;
            background: rgba(255,255,255,.5);
            min-height: 400px;
            display: table;
            position: relative;
            box-shadow: 0 0 4px rgba(0,0,0,.14), 0 4px 8px rgba(0,0,0,.28);
        }

            .veen > div {
                display: table-cell;
                vertical-align: middle;
                text-align: center;
                color: #fff;
            }

            .veen button {
                background: transparent;
                //background-image: linear-gradient(90deg, #e0b722, #ff4931);
                display: inline-block;
                padding: 10px 30px;
                border: 3px solid #fff;
                border-radius: 50px;
                background-clip: padding-box;
                position: relative;
                color: #FFF;
                //box-shadow: 0 0 4px rgba(0,0,0,.14), 0 4px 8px rgba(0,0,0,.28);
                transition: all .25s;
            }

                .veen button.dark {
                    border-color: #ed5b2d;
                    background: #ed5b2d;
                }

            .veen .move button.dark {
                border-color: #ed5b2d;
                background: #ed5b2d;
            }

            .veen button:active {
                box-shadow: none;
            }

            .veen button:focus {
                outline: none;
            }

            .veen > .wrapper {
                position: absolute;
                width: 47%;
                height: 190%;
                top: -43%;
                left: 5%;
                background: #fff;
                box-shadow: 0 0 4px rgba(0,0,0,.14), 0 4px 8px rgba(0,0,0,.28);
                transition: all .5s;
                color: #303030;
                overflow: hidden;
            }

            .veen .wrapper > div {
                padding: 40px 30px 0px;
                width: 100%;
                transition: all .5s;
                background: #fff;
                width: 100%;
            }

                .veen .wrapper > div:focus {
                    outline: none;
                }

            .veen .wrapper #doctor_rgstr {
                padding-top: 40px;
                visibility: visible;
            }

            .veen .wrapper #visitor_rgstr {
                transform: translateY(-80%) translateX(100%);
                visibility: hidden;
            }

            /* .veen .wrapper.move #visitor_rgstr {
                                                                                                                                        transform: translateY(-80%) translateX(0%);
                                                                                                                                        visibility: visible;
                                                                                                                                    } */

            .veen .wrapper.move #visitor_rgstr {
                transform: translateY(-100%) translateX(0%);
                visibility: visible;
            }

            .veen .wrapper.move #doctor_rgstr {
                transform: translateX(-100%);
                visibility: hidden;
            }

            .veen .wrapper > div > div {
                position: relative;
                margin-bottom: 15px;
            }

            .veen .wrapper label {
                position: absolute;
                top: -7px;
                font-size: 12px;
                white-space: nowrap;
                background: #fff;
                text-align: left;
                left: 15px;
                padding: 0 5px;
                color: #00487C;
                pointer-events: none;
            }

            .veen .wrapper h3 {
                margin-bottom: 25px;
                text-align: start;
                color: #000;
            }

            .veen .wrapper input {
                height: 40px;
                padding: 5px 15px;
                width: 100%;
                border: solid 1px #f6ad96;
            }

                .veen .wrapper input:focus {
                    outline: none;
                    border-color: #ed5b2d;
                }

            .veen .wrapper select {
                height: 40px;
                padding: 5px 15px;
                width: 100%;
                border: solid 1px #f6ad96;
            }

                .veen .wrapper select:focus {
                    outline: none;
                    border-color: #ed5b2d;
                }

            .veen > .wrapper.move {
                left: 45%;
            }

                .veen > .wrapper.move input:focus {
                    border-color: #ed5b2d;
                }

        @@media (max-width: 767px) {
            .veen {
                padding: 5px;
                margin: 0;
                width: 100%;
                display: block;
            }

                .veen > .wrapper {
                    position: relative;
                    height: auto;
                    top: 0;
                    left: 0;
                    width: 100%;
                }

                .veen > div {
                    display: inline-block;
                }

            .splits {
                width: 50%;
                background: #fff;
                float: left;
            }

                .splits button {
                    width: 100%;
                    border-radius: 0;
                    background: #505050;
                    border: 0;
                    opacity: .7;
                }

                    .splits button.active {
                        opacity: 1;
                    }

                    .splits button.active {
                        opacity: 1;
                        background: #ed5b2d;
                    }

                .splits.visitor_rgstr-btn button.active {
                    background: #ed5b2d;
                }

                .splits p {
                    display: none;
                }

            .veen > .wrapper.move {
                left: 0%;
            }
        }

        input:-webkit-autofill, textarea:-webkit-autofill, select:-webkit-autofill {
            box-shadow: inset 0 0 0 50px #fff
        }

        .veen .wrapper textarea {
            height: 40px;
            padding: 5px 15px;
            width: 100%;
            border: solid 1px #f6ad96;
        }

            .veen .wrapper textarea:focus {
                outline: none;
                border-color: #ed5b2d;
            }

        .veen > .wrapper.move textarea:focus {
            border-color: #f6ad96;
        }

        .slct-cc {
            height: 40px;
            padding: 5px 15px;
            width: 100%;
            border: solid 1px #999;
        }

        #doctor_rgstr, #visitor_rgstr {
            height: 760px !important;
            overflow-y: scroll;
        }

        h5 {
            margin-right: 3rem !important
        }

        p {
            font-size: 14px !important;
        }

        button {
            border-radius: 3px !important;
        }

        .textColor {
            color: #80a4be !important;
        }

        .img-style {
            width: 18%;
            bottom: 0;
            margin-left: 6%;
            position: absolute;
            z-index: 1;
        }

        /*
                                                                                                                         *  doctor_rgstr
                                                                                                                         */

        .scrollbar::-webkit-scrollbar-track {
            -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
            background-color: #F5F5F5;
        }

        .scrollbar::-webkit-scrollbar {
            width: 6px;
            background-color: #F5F5F5;
        }

        .scrollbar::-webkit-scrollbar-thumb {
            background-color: #ed5b2d;
            background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, .2) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, .2) 50%, rgba(255, 255, 255, .2) 75%, transparent 75%, transparent)
        }

        a {
            color: #ed5b2d;
            text-decoration: underline;
        }

        /*
                                                                                                                        ::placeholder{
                                                                                                                            color: #00000033;
                                                                                                                        }
                                                                                                                      */

        #parsley-visitor-password, #parsley-doctor-password {
            display: none;
        }

        .parsley-password {
            color: red;
            text-align: start;
        }

        #_activationCode {
            border-radius: 3px;
            height: 37px;
        }

        .modal-header {
            background-color: #ed5b2d;
            color: white;
        }

        @@media (max-width: 767px) {

            .splits {
                width: 50%;
                background: #80a4be;
                float: left;
            }

                .splits button {
                    width: 98%;
                    border-radius: 0;
                    background: #ed5b2d;
                    border: 0;
                    opacity: 1;
                }

            .h5_l {
                margin-left: 40px;
            }

            .p_doktor {
                display: block !important;
            }

            .uyeOl {
                background: #3b596f !important;
            }
        }

    </style>
</head>
<body class="col-12 m-0 p-0">
    <div class="body">
        <div>
            <a href="~/Home/Index">
                <center>
                    <img width="100px" class=" mt-3" src="~/assets/images/demans_logo_sm.png" style="border-radius: 65px;" />
                </center>
            </a>
        </div>
        <div class="veen">
            <div class="doctor_rgstr-btn splits">

                <h5 class="h5_l">ÜYE OL</h5>
                <p>Bilgilerini gir ve hayatın içinde kal.</p>
                <button>Doktor Olarak Üye Ol </button>

            </div>
            <div class="visitor_rgstr-btn splits">

                <h5 class="h5_l">GİRİŞ YAP</h5>
                <p style="margin-top:20px !important;">Zaten Üye Misin? <a href="~/Login/Index">Giriş Yap</a></p>
                <button> Giriş Yap</button>

            </div>
            <div class="wrapper">

                <div class="scrollbar" id="doctor_rgstr" tabindex="500">
                    <h1>Üye Ol</h1>
                    @*  <div>
                    <form id="doctor-form">
                    <input type="file" id="Image" accept=".jpg" type="file" name="Image" placeholder="Fotoğraf">
                    </form>
                    <label>FOTOĞRAF</label>
                    </div>*@
                    <div>
                        <input type="text" id="user-name" placeholder="Ad">
                        <label>AD</label>
                    </div>@*USER AD*@
                    <div>
                        <input type="text" id="user-surname" placeholder="Soyad">
                        <label>SOYAD</label>
                    </div>@*USER SOYAD*@
                    <div>
                        <input type="text" id="user-email" placeholder="********.com">
                        <label>E-POSTA</label>
                    </div>@*USER E-POSTA*@
                    <div>
                        <input name="user-password" id="user-password" type="password" placeholder="Şifre">
                        <label>ŞİFRE</label>
                        <p style="text-align:start;" id="doc-pass-length">Şifreniz <strong style="color:#00487C;">en az 6 karakter</strong> uzunluğunda olmalıdır.</p>

                    </div>@*USER ŞİFRE*@
                    <div>
                        <input name="user-password" id="user-again_password" type="password" placeholder="Şifre (Tekrar)">
                        <label>ŞİFRE TEKRAR</label>
                        <p id="parsley-user-password" class="parsley-password">Girdiğiniz şifre aynı olmalıdır.</p>
                    </div>@*USER ŞİFRE TEKRAR*@
                    <div>
                        <input id="user-phone" type="tel" onkeypress="return isNumberKey(event)" placeholder="(xxx)xxx xxxx">
                        <label>TELEFON</label>
                    </div>@*USER TELEFON*@
                    <div>
                        <input id="user-emergency_phone" type="tel" onkeypress="return isNumberKey(event)" placeholder="(xxx)xxx xxxx">
                        <label>ACİL TELEFON</label>
                    </div>@*USER TELEFON ACİL*@
                    <div>
                        <select id="user-gender" class="col-12 slct-cc">
                            <option value="0">Cinsiyet Seçiniz</option>
                            <option value="1">Erkek</option>
                            <option value="2">Kadın</option>
                        </select>
                        <label>CİNSİYET</label>
                    </div>@*USER CİNSİYET*@
                    <div class="submit">
                        <button class="dark" id="userSignUpButton">ÜYE OL</button>
                    </div>
                </div>
                <div class="scrollbar" id="visitor_rgstr">
                    <img src="~/assets/images/subtraction 21.png" height="110px" style="transform: rotate(180deg) translate(68px, 40px);" />
                    <img src="~/assets/images/subtraction 21.png" height="60px" style="transform: rotate(180deg) translate(104px, 65px);filter: opacity(0.8);" />

                    <h1>Giriş Yap</h1>
                    <p class="p-style">E-Posta adresiniz ve şifrenizle hemen giriş yapın.</p>

                    <div>
                        <input type="text" id="_email" placeholder="********.com">
                        <label>E-POSTA</label>
                    </div>@*E-POSTA*@
                    <div>
                        <input name="_password" id="_password" type="password" placeholder="Şifre">
                        <label>ŞİFRE</label>
                    </div>@*ŞİFRE*@

                    <div class="submit">
                        <button class="dark" onclick="getLogIn();">GİRİŞ YAP</button>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div id="activationModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modal-center-title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modal-center-title">AKTİVASYON KODU DOĞRULAMA</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closeModal();">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p><strong>Lütfen mail adresinize gelen aktivasyon kodunu giriniz.</strong></p>
                    <div>
                        <input id="_activationCode" type="number">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="activationCode">GÖNDER</button>
                </div>
            </div>
        </div>
    </div>
    @* <script src="~/js/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script> *@

    <script src="~/assets/js/jquery.min.js"></script>
    <script src="~/plugins/sweet-alert2/sweetalert2.min.js"></script>
    <script src="~/assets/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <script type="text/javascript">
        var aktivasyon_kodu = 0;
        var icon;
        var message;
        $(() => {

            $('.veen .wrapper').addClass('move');
            $('.body').css('background', '#ed5b2d');
            $(".veen .visitor_rgstr-btn button").addClass('uyeOl');

        });

        var myAlert = () => {
            const Toast = Swal.mixin({
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 5000,
                timerProgressBar: true,
                didOpen: (toast) => {
                    toast.addEventListener('mouseenter', Swal.stopTimer)
                    toast.addEventListener('mouseleave', Swal.resumeTimer)
                }
            })
            Toast.fire({
                icon: icon,
                title: message,
                timer: 5000
            });
            return;
        }

        var getLogIn = () => {
            var _email = document.getElementById("_email").value;
            var _password = document.getElementById("_password").value;
            if (!_email || !_password) {

                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 5000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                })
                Toast.fire({
                    icon: 'warning',
                    title: 'Lütfen Zorunlu Alanları(*) Doldurunuz.',
                    timer: 5000
                })

            }
            else if (_email.charAt(0) == " " || _password.charAt(0) == " ") {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 8000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                })
                Toast.fire({
                    icon: 'warning',
                    title: 'Lütfen Boşlukları Doğru Doldurduğunuzdan Emin Olunuz.',
                    timer: 5000
                })

            }
            else {

                $.post('@Url.Action("Index", "Login")', {
                    _email: _email,
                    _password: _password,

                }, (d, s) => {
                    console.log(d);
                    if (d.Messages == 0) {

                        const Toast = Swal.mixin({
                            toast: true,
                            position: 'top-end',
                            showConfirmButton: false,
                            timer: 8000,
                            timerProgressBar: true,
                            didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        })
                        Toast.fire({
                            icon: 'success',
                            title: 'Giriş Yapma İşlemi Başarıyla Gerçekleşti.',
                            timer: 5000
                        })

                        var id = d.Id;
                        if (d.data == "Admin") {
                            //Admin girişi yapıldı
                            window.location.href = '@Url.Action("Index", "A_Users")';

                        } else {
                            console.log(d);
                            console.log(id);

                            // User girişi yapıldı
                            setTimeout(function () {
                                window.location.href = '/U_ProfileDetails/Index/' + id;
                            }, 5000);


                        }

                    } 
                    else if (d.Messages == 1) {
                        const Toast = Swal.mixin({
                            toast: true,
                            position: 'top-end',
                            showConfirmButton: false,
                            timer: 8000,
                            timerProgressBar: true,
                            didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        })
                        Toast.fire({
                            icon: 'error',
                            title: 'Lütfen Kullanıcı Adı veya Şifrenizi doğru girdiğinizden emin olunuz.',
                            timer: 5000
                        })

                    } 
                    else {
                        const Toast = Swal.mixin({
                            toast: true,
                            position: 'top-end',
                            showConfirmButton: false,
                            timer: 8000,
                            timerProgressBar: true,
                            didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        })
                        Toast.fire({
                            icon: 'error',
                            title: 'Giriş yapma işlemi gerçekleştirilemedi.',
                            timer: 5000
                        })
                    }

                })

            }
        }


        var closeModal = () => {
            $('#activationModal').modal('hide');
        }

        jQuery('#userSignUpButton').on('click', function () {

            let u_name = document.getElementById("user-name").value;
            let u_surname = document.getElementById("user-surname").value;
            let u_email = document.getElementById("user-email").value;
            let u_password = document.getElementById("user-password").value;
            let u_again_password = document.getElementById("user-again_password").value;
            let u_phone = document.getElementById("user-phone").value;
            let u_emergency = document.getElementById("user-emergency_phone").value;
            let u_gender = document.getElementById("user-gender").value;

            if (!u_name || !u_surname || !u_email || u_gender == 0 || !u_password || !u_again_password || !u_emergency || !u_phone) {

                icon = "warning";
                message = "Lütfen Zorunlu Alanları(*) Doldurunuz.";
                myAlert();

            }
            else if (u_name.charAt(0) == " " || u_surname.charAt(0) == " " || u_email.charAt(0) == " " || u_password.charAt(0) == " " || u_again_password.charAt(0) == " ") {
                icon = "warning";
                message = "Lütfen Boşlukları Doğru Doldurduğunuzdan Emin Olunuz.";
                myAlert();
            }
            else if (u_password != u_again_password) {

                icon = "error";
                message = "Şifre - Şifre(Tekrar) aynı olmalı.";
                myAlert();
            }
            else {
                $.post('@Url.Action("getActivation", "Login")', {

                    email: u_email,
                    name: u_name,
                }, (d, s) => {
                    if (d.status == true) {
                        aktivasyon_kodu = d.data;
                        $('#activationModal').modal('show');
                    }
                });

            }
        })
        jQuery('#activationCode').on('click', function () {
            var _activationCode = document.getElementById("_activationCode").value;
            if (aktivasyon_kodu == _activationCode) {
                console.log("aktivasyon kodu doğru");

                let u_name = document.getElementById("user-name").value;
                let u_surname = document.getElementById("user-surname").value;
                let u_email = document.getElementById("user-email").value;
                let u_password = document.getElementById("user-password").value;
                let u_again_password = document.getElementById("user-again_password").value;
                let u_phone = document.getElementById("user-phone").value;
                let u_emergency = document.getElementById("user-emergency_phone").value;
                let u_gender = document.getElementById("user-gender").value;

                $.post('@Url.Action("AddUserRegister", "Login")', {
                    u_name: u_name,
                    u_surname: u_surname,
                    u_email: u_email,
                    u_password: u_password,
                    u_gender: u_gender,
                    u_emergency: u_emergency,
                    u_phone: u_phone,
                }, (d, s) => {
                    if (d.status == true) {
                        icon = "success";
                        message = d.message;
                        myAlert();

                        $('.veen .wrapper').addClass('move');
                        $('.body').css('background', '#ed5b2d');
                        $(".veen .doctor_rgstr-btn button").removeClass('active');

                        $(".veen .visitor_rgstr-btn button").addClass('uyeOl');
                        $(".veen .doctor_rgstr-btn button").removeClass('uyeOl');

                        $(this).addClass('active');

                        const inputContainer = document.getElementById('doctor_rgstr');
                        const inputs = inputContainer.getElementsByTagName('input');
                        // Her bir <input> alanının değerini temizleyin
                        for (let i = 0; i < inputs.length; i++) {
                            inputs[i].value = '';
                        }

                    }
                    else {
                        icon = "error";
                        message = d.message;
                        myAlert();

                    }
                });
                closeModal();

            }
            else {
                icon = "error";
                message = "Aktivasyon kodunuz doğru değil. Lütfen tekrar deneyiniz.";
                myAlert();

            }
        });


        $(document).ready(function () {
            $(" .visitor_rgstr-btn").click(function () {
                $('.veen .wrapper').addClass('move');
                $('.body').css('background', '#ed5b2d');
                $(".veen .doctor_rgstr-btn button").removeClass('active');

                $(".veen .visitor_rgstr-btn button").addClass('uyeOl');
                $(".veen .doctor_rgstr-btn button").removeClass('uyeOl');

                $(this).addClass('active');

                const inputContainer = document.getElementById('doctor_rgstr');
                const inputs = inputContainer.getElementsByTagName('input');
                // Her bir <input> alanının değerini temizleyin
                for (let i = 0; i < inputs.length; i++) {
                    inputs[i].value = '';
                }

            });
            $(".doctor_rgstr-btn").click(function () {
                console.log("doctor");
                $('.veen .wrapper').removeClass('move');
                $('.body').css('background', '#ed5b2d');
                $(".veen .visitor_rgstr-btn button").removeClass('active');

                $(".veen .doctor_rgstr-btn button").addClass('uyeOl');
                $(".veen .visitor_rgstr-btn button").removeClass('uyeOl');

                $(this).addClass('active');

                const inputContainer = document.getElementById('visitor_rgstr');
                const inputs = inputContainer.getElementsByTagName('input');
                // Her bir <input> alanının değerini temizleyin
                for (let i = 0; i < inputs.length; i++) {
                    inputs[i].value = '';
                }
                $("#user-gender").val(0);


                document.querySelector("#parsley-user-password").style.display = 'none';
                document.querySelector("#doc-pass-length").style.display = 'block';
            });
        });

        function isNumberKey(evt) {
            var charCode = (evt.which) ? evt.which : event.keyCode;
            if (charCode > 31 && (charCode < 48 || charCode > 57))
                return false;
            return true;
        }

        function phoneMask() {
            var txt = $(this).val().replace(/\D/g, '');
            let newtxt = '';
            for (let i = 0; i < Math.min(txt.length, 10); i++) {
                newtxt += txt[i];
                if ((i == 2) || (i == 5)) {
                    newtxt += ' ';
                }
            }
            if (newtxt[newtxt.length - 1] == ' ') newtxt = newtxt.substring(0, newtxt.length - 1);
            this.value = newtxt;
        }
        $('[type="tel"]').keyup(phoneMask);

        function DPassworControl() {
            var password = document.getElementById("user-password").value;
            var again_password = document.getElementById("user-again_password").value;
            if (password != again_password) {
                document.querySelector("#parsley-user-password").style.display = 'block';
            }
            else {
                document.querySelector("#parsley-user-password").style.display = 'none';
            }
            if (password.length < 6) {
                document.querySelector("#doc-pass-length").style.display = 'block';
            } else {
                document.querySelector("#doc-pass-length").style.display = 'none';
            }
        }
        $('[name="user-password"]').keyup(DPassworControl);

    </script>
</body>
</html>